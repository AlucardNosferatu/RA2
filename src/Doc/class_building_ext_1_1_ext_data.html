<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Ares: BuildingExt::ExtData Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Ares</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="class_building_ext.html">BuildingExt</a>      </li>
      <li class="navelem"><a class="el" href="class_building_ext_1_1_ext_data.html">ExtData</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a>  </div>
  <div class="headertitle">
<h1>BuildingExt::ExtData Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="BuildingExt::ExtData" --><!-- doxytag: inherits="Extension&lt; TT &gt;" -->
<p><code>#include &lt;src/Ext/Building/Body.h&gt;</code></p>
<div class="dynheader">
Inheritance diagram for BuildingExt::ExtData:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_building_ext_1_1_ext_data.png" usemap="#BuildingExt::ExtData_map" alt=""/>
  <map id="BuildingExt::ExtData_map" name="BuildingExt::ExtData_map">
<area href="class_extension.html" alt="Extension&lt; TT &gt;" shape="rect" coords="0,0,123,24"/>
</map>
 </div></div>

<p><a href="class_building_ext_1_1_ext_data-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#afe9c0557cebc23cf41212d86b0403b4f">InfiltratedBy</a> (HouseClass *Enterer)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#ae8b62f255c63793312f46bcc1c2c7134">ExtData</a> (const DWORD <a class="el" href="class_extension.html#a2f0c543d5bceafd46d103be4f87a5abe">Canary</a>, <a class="el" href="class_building_ext.html#a66c50954e22686f620bf9dd86ec856b9">TT</a> *const OwnerObject)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#ac5b77e77f3df5476e22f21b5e7930ee3">~ExtData</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#a9a142e25874321613a711b2f196a5982">Size</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#a3a99ceb814144b0e760b723e81bfc075">InvalidatePointer</a> (void *ptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#a11c2bdd38f872dccf64d147cbcffbadf">RubbleYell</a> (bool beingRepaired=false)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This function switches the building into its Advanced Rubble state or back to normal.  <a href="#a11c2bdd38f872dccf64d147cbcffbadf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#a9e1fb291c1b79b60802734e41da10db4">KickOutOfRubble</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Bumps all Technos that reside on a building's foundation out of the way.  <a href="#a9e1fb291c1b79b60802734e41da10db4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#a7e7dd93da28363b5205c6cda4a2a938b">canTraverseTo</a> (BuildingClass *targetBuilding)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This function checks if occupants of the current building can, on principle, move on to the target building.  <a href="#a7e7dd93da28363b5205c6cda4a2a938b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#a906e57980b9e5d921e3df6575f780dc8">doTraverseTo</a> (BuildingClass *targetBuilding)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This function moves as many occupants as possible from the current to the target building.  <a href="#a906e57980b9e5d921e3df6575f780dc8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#a88c90fd40e919715f1d0ccabcd0c8121">sameTrench</a> (BuildingClass *targetBuilding)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This function checks if the current and the target building are both of the same trench kind.  <a href="#a88c90fd40e919715f1d0ccabcd0c8121"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#a39cc147927fcbc639e64d3261d415442">isLinkable</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if this is a structure that can be linked to other structures, like a wall, fence, or trench. This is used to quick-check if the game has to look for linkable buildings in the first place.  <a href="#a39cc147927fcbc639e64d3261d415442"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#a85968e3b639ee4a5b6c62c27fec80f26">canLinkTo</a> (BuildingClass *targetBuilding)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the current building can link to the given target building.  <a href="#a85968e3b639ee4a5b6c62c27fec80f26"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#a35389a02d691eda3df45bb34487bd967">evalRaidStatus</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the building is empty but still marked as raided, and returns the building to its previous owner, if so.  <a href="#a35389a02d691eda3df45bb34487bd967"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#a0ed3f40c70d8c03aca843297a3587b30">UpdateFirewall</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#a21a5f7c8f4bb43c82dcc2e03b6681291">ImmolateVictims</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#a59a0e98ecfd29e31d7950018e82483e7">ImmolateVictim</a> (ObjectClass *Victim)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#aa52160d197643b1ec47982baea06a2cd">ReverseEngineer</a> (TechnoClass *Victim)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if Victim wasn't buildable and now should be.  <a href="#aa52160d197643b1ec47982baea06a2cd"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">HouseClass *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#afead3304480fed76856d3e8048dc020d">OwnerBeforeRaid</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains the house which owned this building prior to it being raided and turned over to the raiding party.  <a href="#afead3304480fed76856d3e8048dc020d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#afa7ba845c44fb28da0ffdf2b7b7c5667">isCurrentlyRaided</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether this building is currently occupied by someone not the actual owner of the structure.  <a href="#afa7ba845c44fb28da0ffdf2b7b7c5667"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#a0d8c28c2f33fc5710e8aa2dd8da374e0">ignoreNextEVA</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This is used when returning raided buildings, to decide whether to play EVA announcements about building capture.  <a href="#a0d8c28c2f33fc5710e8aa2dd8da374e0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#ab5ab1574ad150a14f8e46f2a08094cda">FreeUnits_Done</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Prevent free units and aircraft to be created multiple times. Set when the free units have been granted.  <a href="#ab5ab1574ad150a14f8e46f2a08094cda"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#aa94d26e570d86791fabc7919e238a6fc">AboutToChronoshift</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This building is going to be shifted. It should not be attacked with temporal weapons now. Otherwise it would disappear.  <a href="#aa94d26e570d86791fabc7919e238a6fc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_building_ext_1_1c_prism_forwarding.html">cPrismForwarding</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::set&lt; TechnoClass * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_building_ext_1_1_ext_data.html#ad7f420d1c0f2af081419b11913a5a17f">RegisteredJammers</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set of Radar Jammers which have registered themselves to be in range of this building. (Related to issue #305)  <a href="#ad7f420d1c0f2af081419b11913a5a17f"></a><br/></td></tr>
</table>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ae8b62f255c63793312f46bcc1c2c7134"></a><!-- doxytag: member="BuildingExt::ExtData::ExtData" ref="ae8b62f255c63793312f46bcc1c2c7134" args="(const DWORD Canary, TT *const OwnerObject)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BuildingExt::ExtData::ExtData </td>
          <td>(</td>
          <td class="paramtype">const DWORD&#160;</td>
          <td class="paramname"><em>Canary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_building_ext.html#a66c50954e22686f620bf9dd86ec856b9">TT</a> *const&#160;</td>
          <td class="paramname"><em>OwnerObject</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">                                                                   : <a class="code" href="class_extension.html">Extension&lt;TT&gt;</a>(<a class="code" href="class_extension.html#a2f0c543d5bceafd46d103be4f87a5abe">Canary</a>, OwnerObject),
                        <a class="code" href="class_building_ext_1_1_ext_data.html#afead3304480fed76856d3e8048dc020d" title="Contains the house which owned this building prior to it being raided and turned over to the raiding ...">OwnerBeforeRaid</a>(NULL), <a class="code" href="class_building_ext_1_1_ext_data.html#afa7ba845c44fb28da0ffdf2b7b7c5667" title="Whether this building is currently occupied by someone not the actual owner of the structure...">isCurrentlyRaided</a>(<span class="keyword">false</span>), <a class="code" href="class_building_ext_1_1_ext_data.html#a0d8c28c2f33fc5710e8aa2dd8da374e0" title="This is used when returning raided buildings, to decide whether to play EVA announcements about build...">ignoreNextEVA</a>(<span class="keyword">false</span>), <a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>(), <a class="code" href="class_building_ext_1_1_ext_data.html#ab5ab1574ad150a14f8e46f2a08094cda" title="Prevent free units and aircraft to be created multiple times. Set when the free units have been grant...">FreeUnits_Done</a>(<span class="keyword">false</span>), <a class="code" href="class_building_ext_1_1_ext_data.html#aa94d26e570d86791fabc7919e238a6fc" title="This building is going to be shifted. It should not be attacked with temporal weapons now...">AboutToChronoshift</a>(<span class="keyword">false</span>)
                        { };
</pre></div>
</div>
</div>
<a class="anchor" id="ac5b77e77f3df5476e22f21b5e7930ee3"></a><!-- doxytag: member="BuildingExt::ExtData::~ExtData" ref="ac5b77e77f3df5476e22f21b5e7930ee3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual BuildingExt::ExtData::~ExtData </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">                                   {
                        <a class="code" href="class_building_type_ext_1_1c_prism_forwarding.html#a5206e79b50240897a6d33b76cbd1905d">BuildingTypeExt::cPrismForwarding::RemoveFromNetwork</a>(this-&gt;<a class="code" href="class_extension.html#a72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>, <span class="keyword">true</span>);
                }
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a85968e3b639ee4a5b6c62c27fec80f26"></a><!-- doxytag: member="BuildingExt::ExtData::canLinkTo" ref="a85968e3b639ee4a5b6c62c27fec80f26" args="(BuildingClass *targetBuilding)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BuildingExt::ExtData::canLinkTo </td>
          <td>(</td>
          <td class="paramtype">BuildingClass *&#160;</td>
          <td class="paramname"><em>targetBuilding</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Checks if the current building can link to the given target building. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">targetBuilding</td><td>the building to check for compatibility. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if the two buildings can be linked. </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="class_building_ext_1_1_ext_data.html#a39cc147927fcbc639e64d3261d415442" title="Returns true if this is a structure that can be linked to other structures, like a wall...">isLinkable()</a> </dd></dl>
<div class="fragment"><pre class="fragment">                                                                {
        BuildingClass* currentBuilding = this-&gt;<a class="code" href="class_extension.html#a72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>;

        <span class="comment">// Different owners // and owners not allied</span>
        <span class="keywordflow">if</span>((currentBuilding-&gt;Owner != targetBuilding-&gt;Owner) &amp;&amp; !currentBuilding-&gt;Owner-&gt;IsAlliedWith(targetBuilding-&gt;Owner)) { <span class="comment">//&lt;-- see thread 1424</span>
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }

        <a class="code" href="class_building_type_ext_1_1_ext_data.html">BuildingTypeExt::ExtData</a>* currentTypeExtData = <a class="code" href="class_building_type_ext.html#a9643fa629dd6d2a20eeefa4942d8612a">BuildingTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(currentBuilding-&gt;Type);
        <a class="code" href="class_building_type_ext_1_1_ext_data.html">BuildingTypeExt::ExtData</a>* targetTypeExtData = <a class="code" href="class_building_type_ext.html#a9643fa629dd6d2a20eeefa4942d8612a">BuildingTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(targetBuilding-&gt;Type);

        <span class="comment">// Firewalls</span>
        <span class="keywordflow">if</span>(currentTypeExtData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#a546647f34224bbd9057c36ea89eb4763">Firewall_Is</a> &amp;&amp; targetTypeExtData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#a546647f34224bbd9057c36ea89eb4763">Firewall_Is</a>) {
                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }

        <span class="comment">// Trenches</span>
        <span class="keywordflow">if</span>(this-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a88c90fd40e919715f1d0ccabcd0c8121" title="This function checks if the current and the target building are both of the same trench kind...">sameTrench</a>(targetBuilding)) {
                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }

        <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7e7dd93da28363b5205c6cda4a2a938b"></a><!-- doxytag: member="BuildingExt::ExtData::canTraverseTo" ref="a7e7dd93da28363b5205c6cda4a2a938b" args="(BuildingClass *targetBuilding)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BuildingExt::ExtData::canTraverseTo </td>
          <td>(</td>
          <td class="paramtype">BuildingClass *&#160;</td>
          <td class="paramname"><em>targetBuilding</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function checks if occupants of the current building can, on principle, move on to the target building. </p>
<p>Conditions checked are whether there are occupants in the current building, whether the target building is full, whether the current building even is a trench, and whether both buildings are of the same trench kind.</p>
<p>The current system assumes 1x1 sized trench parts; it will probably work in all cases where the 0,0 (top) cells of buildings touch (e.g. a 3x3 building next to a 1x3 building), but not when the 0,0 cells are further apart. This may be changed at a later point in time, if there is demand for it.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">targetBuilding</td><td>a pointer to the target building. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if traversal between both buildings is legal, otherwise false. </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="class_building_ext_1_1_ext_data.html#a906e57980b9e5d921e3df6575f780dc8" title="This function moves as many occupants as possible from the current to the target building.">doTraverseTo()</a></dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>Renegade </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>16.12.09+ </dd></dl>
<div class="fragment"><pre class="fragment">                                                                    {
        BuildingClass* currentBuilding = this-&gt;<a class="code" href="class_extension.html#a72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>;
        <span class="comment">//BuildingTypeClass* currentBuildingType = game_cast&lt;BuildingTypeClass *&gt;(currentBuilding-&gt;GetTechnoType());</span>
        BuildingTypeClass* targetBuildingType = targetBuilding-&gt;Type;

        <span class="keywordflow">if</span>((targetBuilding == currentBuilding)
                || (targetBuilding-&gt;Occupants.Count &gt;= targetBuildingType-&gt;MaxNumberOccupants)
                || !currentBuilding-&gt;Occupants.Count
                || !targetBuildingType-&gt;CanBeOccupied) { <span class="comment">// I&#39;m a little if-clause short and stdout... // beat you to the punchline -- D</span>
                <span class="comment">// Can&#39;t traverse if there&#39;s no one to move, or the target is full, we can&#39;t actually occupy the target,</span>
                <span class="comment">// or if it&#39;s actually the same building</span>
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }

        <a class="code" href="class_building_type_ext_1_1_ext_data.html">BuildingTypeExt::ExtData</a>* currentBuildingTypeExt = <a class="code" href="class_building_type_ext.html#a9643fa629dd6d2a20eeefa4942d8612a">BuildingTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(currentBuilding-&gt;Type);
        <a class="code" href="class_building_type_ext_1_1_ext_data.html">BuildingTypeExt::ExtData</a>* targetBuildingTypeExt = <a class="code" href="class_building_type_ext.html#a9643fa629dd6d2a20eeefa4942d8612a">BuildingTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(targetBuilding-&gt;Type);

        <span class="keywordflow">if</span>(this-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a88c90fd40e919715f1d0ccabcd0c8121" title="This function checks if the current and the target building are both of the same trench kind...">sameTrench</a>(targetBuilding)) {
                <span class="comment">// if we&#39;ve come here, there&#39;s room, there are people to move, and the buildings are trenches and of the same kind</span>
                <span class="comment">// the only questioning remaining is whether they are next to each other.</span>
                <span class="comment">// if the target building is more than 256 leptons away, it&#39;s not on a straight neighboring cell.</span>
                <span class="keywordflow">return</span> targetBuilding-&gt;Location.DistanceFrom(currentBuilding-&gt;Location) &lt;= 256.0;

        } <span class="keywordflow">else</span> {
                <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// not the same trench kind or not a trench</span>
        }

}
</pre></div>
</div>
</div>
<a class="anchor" id="a906e57980b9e5d921e3df6575f780dc8"></a><!-- doxytag: member="BuildingExt::ExtData::doTraverseTo" ref="a906e57980b9e5d921e3df6575f780dc8" args="(BuildingClass *targetBuilding)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BuildingExt::ExtData::doTraverseTo </td>
          <td>(</td>
          <td class="paramtype">BuildingClass *&#160;</td>
          <td class="paramname"><em>targetBuilding</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function moves as many occupants as possible from the current to the target building. </p>
<p>This function will move occupants from the current building to the target building until either a) the target building is full, or b) the current building is empty.</p>
<dl class="warning"><dt><b>Warning:</b></dt><dd>The function assumes the legality of the traversal was checked beforehand with <a class="el" href="class_building_ext_1_1_ext_data.html#a7e7dd93da28363b5205c6cda4a2a938b" title="This function checks if occupants of the current building can, on principle, move on to the target bu...">canTraverseTo()</a>, and will therefore not do any safety checks.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">targetBuilding</td><td>a pointer to the target building. </td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="class_building_ext_1_1_ext_data.html#a7e7dd93da28363b5205c6cda4a2a938b" title="This function checks if occupants of the current building can, on principle, move on to the target bu...">canTraverseTo()</a></dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>Renegade </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>16.12.09+ </dd></dl>
<div class="fragment"><pre class="fragment">                                                                   {
        BuildingClass* currentBuilding = this-&gt;<a class="code" href="class_extension.html#a72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>;
        BuildingTypeClass* targetBuildingType = targetBuilding-&gt;Type;

        <span class="comment">// depending on Westwood&#39;s handling, this could explode when Size &gt; 1 units are involved...but don&#39;t tell the users that</span>
        <span class="keywordflow">while</span>(currentBuilding-&gt;Occupants.Count &amp;&amp; (targetBuilding-&gt;Occupants.Count &lt; targetBuildingType-&gt;MaxNumberOccupants)) {
                targetBuilding-&gt;Occupants.AddItem(currentBuilding-&gt;Occupants.GetItem(0));
                currentBuilding-&gt;Occupants.RemoveItem(0); <span class="comment">// maybe switch Add/Remove if the game gets pissy about multiple of them walking around</span>
        }

        this-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a35389a02d691eda3df45bb34487bd967" title="Checks if the building is empty but still marked as raided, and returns the building to its previous ...">evalRaidStatus</a>(); <span class="comment">// if the traversal emptied the current building, it&#39;ll have to be returned to its owner</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a35389a02d691eda3df45bb34487bd967"></a><!-- doxytag: member="BuildingExt::ExtData::evalRaidStatus" ref="a35389a02d691eda3df45bb34487bd967" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BuildingExt::ExtData::evalRaidStatus </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Checks if the building is empty but still marked as raided, and returns the building to its previous owner, if so. </p>
<div class="fragment"><pre class="fragment">                                        {
        <span class="comment">// if the building is still marked as raided, but unoccupied, return it to its previous owner</span>
        <span class="keywordflow">if</span>(this-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#afa7ba845c44fb28da0ffdf2b7b7c5667" title="Whether this building is currently occupied by someone not the actual owner of the structure...">isCurrentlyRaided</a> &amp;&amp; !this-&gt;<a class="code" href="class_extension.html#a72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>-&gt;Occupants.Count) {
                <span class="comment">// Fix for #838: Only return the building to the previous owner if he hasn&#39;t been defeated</span>
                <span class="keywordflow">if</span>(!this-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#afead3304480fed76856d3e8048dc020d" title="Contains the house which owned this building prior to it being raided and turned over to the raiding ...">OwnerBeforeRaid</a>-&gt;Defeated) {
                        this-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a0d8c28c2f33fc5710e8aa2dd8da374e0" title="This is used when returning raided buildings, to decide whether to play EVA announcements about build...">ignoreNextEVA</a> = <span class="keyword">true</span>; <span class="comment">// #698 - used in BuildingClass_ChangeOwnership_TrenchEVA to override EVA announcement</span>
                        this-&gt;<a class="code" href="class_extension.html#a72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>-&gt;SetOwningHouse(this-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#afead3304480fed76856d3e8048dc020d" title="Contains the house which owned this building prior to it being raided and turned over to the raiding ...">OwnerBeforeRaid</a>);
                }
                this-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#afead3304480fed76856d3e8048dc020d" title="Contains the house which owned this building prior to it being raided and turned over to the raiding ...">OwnerBeforeRaid</a> = NULL;
                this-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#afa7ba845c44fb28da0ffdf2b7b7c5667" title="Whether this building is currently occupied by someone not the actual owner of the structure...">isCurrentlyRaided</a> = <span class="keyword">false</span>;
        }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a59a0e98ecfd29e31d7950018e82483e7"></a><!-- doxytag: member="BuildingExt::ExtData::ImmolateVictim" ref="a59a0e98ecfd29e31d7950018e82483e7" args="(ObjectClass *Victim)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BuildingExt::ExtData::ImmolateVictim </td>
          <td>(</td>
          <td class="paramtype">ObjectClass *&#160;</td>
          <td class="paramname"><em>Victim</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">                                                            {
        BuildingClass *pThis = this-&gt;<a class="code" href="class_extension.html#a72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>;
        <span class="keywordflow">if</span>(generic_cast&lt;TechnoClass *&gt;(Victim) &amp;&amp; Victim != pThis &amp;&amp; !Victim-&gt;InLimbo &amp;&amp; Victim-&gt;IsAlive &amp;&amp; Victim-&gt;Health) {
                CoordStruct XYZ;
                Victim-&gt;GetCoords(&amp;XYZ);
                <span class="keywordtype">int</span> Damage = Victim-&gt;Health;
                Victim-&gt;ReceiveDamage(&amp;Damage, 0, RulesClass::Instance-&gt;C4Warhead<span class="comment">/* todo */</span>, 0, 1, 0, pThis-&gt;Owner);

                <span class="keywordflow">if</span>(AnimTypeClass *FSAnim = AnimTypeClass::Find(Victim-&gt;IsInAir() ? <span class="stringliteral">&quot;FSAIR&quot;</span> : <span class="stringliteral">&quot;FSGRND&quot;</span>)) {
                        AnimClass * placeholder;
                        GAME_ALLOC(AnimClass, placeholder, FSAnim, &amp;XYZ);
                }

        }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a21a5f7c8f4bb43c82dcc2e03b6681291"></a><!-- doxytag: member="BuildingExt::ExtData::ImmolateVictims" ref="a21a5f7c8f4bb43c82dcc2e03b6681291" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BuildingExt::ExtData::ImmolateVictims </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">                                         {
        CellClass *C = this-&gt;<a class="code" href="class_extension.html#a72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>-&gt;GetCell();
        <span class="keywordflow">for</span>(ObjectClass *O = C-&gt;GetContent(); O; O = O-&gt;NextObject) {
                this-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a59a0e98ecfd29e31d7950018e82483e7">ImmolateVictim</a>(O);
        }
}
</pre></div>
</div>
</div>
<a class="anchor" id="afe9c0557cebc23cf41212d86b0403b4f"></a><!-- doxytag: member="BuildingExt::ExtData::InfiltratedBy" ref="afe9c0557cebc23cf41212d86b0403b4f" args="(HouseClass *Enterer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BuildingExt::ExtData::InfiltratedBy </td>
          <td>(</td>
          <td class="paramtype">HouseClass *&#160;</td>
          <td class="paramname"><em>Enterer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">                                                          {
        BuildingClass *EnteredBuilding = this-&gt;<a class="code" href="class_extension.html#a72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>;
        BuildingTypeClass *EnteredType = EnteredBuilding-&gt;Type;
        HouseClass *Owner = EnteredBuilding-&gt;Owner;
        <a class="code" href="class_building_type_ext_1_1_ext_data.html">BuildingTypeExt::ExtData</a>* pTypeExt = <a class="code" href="class_building_type_ext.html#a9643fa629dd6d2a20eeefa4942d8612a">BuildingTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(EnteredBuilding-&gt;Type);
        <a class="code" href="class_house_ext_1_1_ext_data.html">HouseExt::ExtData</a>* pEntererExt = <a class="code" href="class_house_ext.html#a4a73e500fabd21a7359c5247c31d4c03">HouseExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(Enterer);

        <span class="keywordflow">if</span>(!pTypeExt-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#a9c991715c07b377e40cc8fb139585f4b">InfiltrateCustom</a>) {
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }

        <span class="keywordflow">if</span>(Owner == Enterer) {
                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }

        <span class="keywordtype">bool</span> raiseEva = <span class="keyword">false</span>;

        <span class="keywordflow">if</span>(Enterer-&gt;ControlledByPlayer() || Owner-&gt;ControlledByPlayer()) {
                CellStruct xy;
                EnteredBuilding-&gt;GetMapCoords(&amp;xy);
                <span class="keywordflow">if</span>(RadarEventClass::Create(RADAREVENT_STRUCTUREINFILTRATED, xy)) {
                        raiseEva = <span class="keyword">true</span>;
                }
        }

        <span class="keywordtype">bool</span> evaForOwner = Owner-&gt;ControlledByPlayer() &amp;&amp; raiseEva;
        <span class="keywordtype">bool</span> evaForEnterer = Enterer-&gt;ControlledByPlayer() &amp;&amp; raiseEva;
        <span class="keywordtype">bool</span> effectApplied = <span class="keyword">false</span>;

        <span class="keywordflow">if</span>(pTypeExt-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#a0ab907105501701eed526e983b282f75">ResetRadar</a>.<a class="code" href="class_valueable.html#a2e7156efef9fa4f180a95b7f80cf8129">Get</a>()) {
                Owner-&gt;ReshroudMap();
                <span class="keywordflow">if</span>(!Owner-&gt;SpySatActive &amp;&amp; evaForOwner) {
                        VoxClass::Play(<span class="stringliteral">&quot;EVA_RadarSabotaged&quot;</span>);
                }
                <span class="keywordflow">if</span>(!Owner-&gt;SpySatActive &amp;&amp; evaForEnterer) {
                        VoxClass::Play(<span class="stringliteral">&quot;EVA_BuildingInfRadarSabotaged&quot;</span>);
                }
                effectApplied = <span class="keyword">true</span>;
        }


        <span class="keywordflow">if</span>(pTypeExt-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#a73061b5f25f3fcf9be7f3b783f9b5138">PowerOutageDuration</a> &gt; 0) {
                Owner-&gt;CreatePowerOutage(pTypeExt-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#a73061b5f25f3fcf9be7f3b783f9b5138">PowerOutageDuration</a>);
                <span class="keywordflow">if</span>(evaForOwner) {
                        VoxClass::Play(<span class="stringliteral">&quot;EVA_PowerSabotaged&quot;</span>);
                }
                <span class="keywordflow">if</span>(evaForEnterer) {
                        VoxClass::Play(<span class="stringliteral">&quot;EVA_BuildingInfiltrated&quot;</span>);
                        VoxClass::Play(<span class="stringliteral">&quot;EVA_EnemyBasePoweredDown&quot;</span>);
                }
                effectApplied = <span class="keyword">true</span>;
        }


        <span class="keywordflow">if</span>(pTypeExt-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#a5a36f005a5868862a893782ce2677ac8">StolenTechIndex</a> &gt; -1) {
                pEntererExt-&gt;<a class="code" href="class_house_ext_1_1_ext_data.html#a6925284d3818ae639a29a7ac1eac9df1">StolenTech</a>.set(pTypeExt-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#a5a36f005a5868862a893782ce2677ac8">StolenTechIndex</a>);

                Enterer-&gt;ShouldRecheckTechTree = <span class="keyword">true</span>;
                <span class="keywordflow">if</span>(evaForOwner) {
                        VoxClass::Play(<span class="stringliteral">&quot;EVA_TechnologyStolen&quot;</span>);
                }
                <span class="keywordflow">if</span>(evaForEnterer) {
                        VoxClass::Play(<span class="stringliteral">&quot;EVA_BuildingInfiltrated&quot;</span>);
                        VoxClass::Play(<span class="stringliteral">&quot;EVA_NewTechnologyAcquired&quot;</span>);
                }
                effectApplied = <span class="keyword">true</span>;
        }


        <span class="keywordflow">if</span>(pTypeExt-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#aafe33070a001dfd05280eec5cde4a0f4">UnReverseEngineer</a>.<a class="code" href="class_valueable.html#a2e7156efef9fa4f180a95b7f80cf8129">Get</a>()) {
                <span class="keywordtype">int</span> idx = HouseClass::Array-&gt;FindItemIndex(&amp;Owner);

                Debug::Log(<span class="stringliteral">&quot;Undoing all Reverse Engineering achieved by house %ls (#%d)\n&quot;</span>, Owner-&gt;UIName, idx);

                <span class="keywordflow">if</span>(idx != -1) {
                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; TechnoTypeClass::Array-&gt;Count; ++i) {
                                TechnoTypeClass * Type = TechnoTypeClass::Array-&gt;GetItem(i);
                                <a class="code" href="class_techno_type_ext_1_1_ext_data.html">TechnoTypeExt::ExtData</a> * TypeData = <a class="code" href="class_techno_type_ext.html#acc5f01db1b341572a92ad754a7d15c48">TechnoTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(Type);
                                <span class="keywordflow">if</span>(TypeData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#aa04bc25ff69390fa0a1b3e1ea3ac1a90">ReversedByHouses</a>.ValidIndex(idx)) {
                                        Debug::Log(<span class="stringliteral">&quot;Zeroing out RevEng of %s\n&quot;</span>, Type-&gt;ID);
                                        TypeData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#aa04bc25ff69390fa0a1b3e1ea3ac1a90">ReversedByHouses</a>[idx] = <span class="keyword">false</span>;
                                }
                        }
                        Owner-&gt;ShouldRecheckTechTree = <span class="keyword">true</span>;
                }

                <span class="keywordflow">if</span>(evaForOwner) {
                        VoxClass::Play(<span class="stringliteral">&quot;EVA_BuildingInfiltrated&quot;</span>);
                }
                <span class="keywordflow">if</span>(evaForEnterer) {
                        VoxClass::Play(<span class="stringliteral">&quot;EVA_BuildingInfiltrated&quot;</span>);
                }
                effectApplied = <span class="keyword">true</span>;
        }


        <span class="keywordflow">if</span>(pTypeExt-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#a5c7f14dd15fbbbca59fbd7028c20ef07">ResetSW</a>.<a class="code" href="class_valueable.html#a2e7156efef9fa4f180a95b7f80cf8129">Get</a>()) {
                <span class="keywordtype">bool</span> somethingReset = <span class="keyword">false</span>;
                <span class="keywordtype">int</span> swIdx = EnteredType-&gt;SuperWeapon;
                <span class="keywordflow">if</span>(swIdx != -1) {
                        Owner-&gt;Supers.Items[swIdx]-&gt;Reset();
                        somethingReset = <span class="keyword">true</span>;
                }
                swIdx = EnteredType-&gt;SuperWeapon2;
                <span class="keywordflow">if</span>(swIdx != -1) {
                        Owner-&gt;Supers.Items[swIdx]-&gt;Reset();
                        somethingReset = <span class="keyword">true</span>;
                }
                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; EnteredType-&gt;Upgrades; ++i) {
                        <span class="keywordflow">if</span>(BuildingTypeClass *Upgrade = EnteredBuilding-&gt;Upgrades[i]) {
                                swIdx = Upgrade-&gt;SuperWeapon;
                                <span class="keywordflow">if</span>(swIdx != -1) {
                                        Owner-&gt;Supers.Items[swIdx]-&gt;Reset();
                                        somethingReset = <span class="keyword">true</span>;
                                }
                                swIdx = Upgrade-&gt;SuperWeapon2;
                                <span class="keywordflow">if</span>(swIdx != -1) {
                                        Owner-&gt;Supers.Items[swIdx]-&gt;Reset();
                                        somethingReset = <span class="keyword">true</span>;
                                }
                        }
                }

                <span class="keywordflow">if</span>(somethingReset) {
                        <span class="keywordflow">if</span>(evaForOwner || evaForEnterer) {
                                VoxClass::Play(<span class="stringliteral">&quot;EVA_BuildingInfiltrated&quot;</span>);
                        }
                        effectApplied = <span class="keyword">true</span>;
                }
        }


        <span class="keywordtype">int</span> bounty = 0;
        <span class="keywordtype">int</span> available = Owner-&gt;Available_Money();
        <span class="keywordflow">if</span>(pTypeExt-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#afdf8c51977e5d76a168fdbb6185e12d2">StolenMoneyAmount</a> &gt; 0) {
                bounty = pTypeExt-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#afdf8c51977e5d76a168fdbb6185e12d2">StolenMoneyAmount</a>;
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(pTypeExt-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#ac4b24dc0ce25757fb1ba09a3ebc97e0f">StolenMoneyPercentage</a> &gt; 0) {
                bounty = int(available * pTypeExt-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#ac4b24dc0ce25757fb1ba09a3ebc97e0f">StolenMoneyPercentage</a>);
        }
        <span class="keywordflow">if</span>(bounty &gt; 0) {
                bounty = std::min(bounty, available);
                Owner-&gt;TakeMoney(bounty);
                Enterer-&gt;GiveMoney(bounty);
                <span class="keywordflow">if</span>(evaForOwner) {
                        VoxClass::Play(<span class="stringliteral">&quot;EVA_CashStolen&quot;</span>);
                }
                <span class="keywordflow">if</span>(evaForEnterer) {
                        VoxClass::Play(<span class="stringliteral">&quot;EVA_BuildingInfCashStolen&quot;</span>);
                }
                effectApplied = <span class="keyword">true</span>;
        }


        <span class="keywordflow">if</span>(pTypeExt-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#ac625dca325224abc0e829b9dfdd35322">GainVeterancy</a>.<a class="code" href="class_valueable.html#a2e7156efef9fa4f180a95b7f80cf8129">Get</a>()) {
                <span class="keywordtype">bool</span> promotionStolen = <span class="keyword">true</span>;

                <span class="keywordflow">switch</span>(EnteredType-&gt;Factory) {
                        <span class="keywordflow">case</span> UnitTypeClass::AbsID:
                                Enterer-&gt;WarFactoryInfiltrated = <span class="keyword">true</span>;
                                <span class="keywordflow">break</span>;
                        <span class="keywordflow">case</span> InfantryTypeClass::AbsID:
                                Enterer-&gt;BarracksInfiltrated = <span class="keyword">true</span>;
                                <span class="keywordflow">break</span>;
                                <span class="comment">// TODO: aircraft/building</span>
                        <span class="keywordflow">default</span>:
                                promotionStolen = <span class="keyword">false</span>;
                }

                <span class="keywordflow">if</span>(promotionStolen) {
                        Enterer-&gt;ShouldRecheckTechTree = <span class="keyword">true</span>;
                        <span class="keywordflow">if</span>(Enterer-&gt;ControlledByPlayer()) {
                                MouseClass::Instance-&gt;SidebarNeedsRepaint();
                        }
                        <span class="keywordflow">if</span>(evaForOwner) {
                                VoxClass::Play(<span class="stringliteral">&quot;EVA_TechnologyStolen&quot;</span>);
                        }
                        <span class="keywordflow">if</span>(evaForEnterer) {
                                VoxClass::Play(<span class="stringliteral">&quot;EVA_BuildingInfiltrated&quot;</span>);
                                VoxClass::Play(<span class="stringliteral">&quot;EVA_NewTechnologyAcquired&quot;</span>);
                        }
                        effectApplied = <span class="keyword">true</span>;
                }
        }


        <span class="comment">/*      RA1-Style Spying, as requested in issue #633</span>
<span class="comment">                This sets the respective bit to inform the game that a particular house has spied this building.</span>
<span class="comment">                Knowing that, the game will reveal the current production in this building to the players who have spied it.</span>
<span class="comment">                In practice, this means: If a player who has spied a factory clicks on that factory,</span>
<span class="comment">                he will see the cameo of whatever is being built in the factory.</span>
<span class="comment"></span>
<span class="comment">                Addition 04.03.10: People complained about it not being optional. Now it is.</span>
<span class="comment">        */</span>
        <span class="keywordflow">if</span>(pTypeExt-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#a1b663708a63c3570263c7da81673fc90">RevealProduction</a>.<a class="code" href="class_valueable.html#a2e7156efef9fa4f180a95b7f80cf8129">Get</a>()) {
                EnteredBuilding-&gt;DisplayProductionTo.Add(Enterer);
                <span class="keywordflow">if</span>(evaForOwner || evaForEnterer) {
                        VoxClass::Play(<span class="stringliteral">&quot;EVA_BuildingInfiltrated&quot;</span>);
                }
                effectApplied = <span class="keyword">true</span>;
        }

        <span class="keywordflow">if</span>(pTypeExt-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#aa4a1ce7bf0b8fdebf2819aa189ccf846">RevealRadar</a>.<a class="code" href="class_valueable.html#a2e7156efef9fa4f180a95b7f80cf8129">Get</a>()) {
                EnteredBuilding-&gt;DisplayProductionTo.Add(Enterer);
                <a class="code" href="class_building_ext.html#a7cc1e762dfcded375fd8d8f53f23e700">BuildingExt::UpdateDisplayTo</a>(EnteredBuilding);
                <span class="keywordflow">if</span>(evaForOwner || evaForEnterer) {
                        VoxClass::Play(<span class="stringliteral">&quot;EVA_BuildingInfiltrated&quot;</span>);
                }
                MapClass::Instance-&gt;sub_657CE0();
                MapClass::Instance-&gt;RedrawSidebar(2);
                effectApplied = <span class="keyword">true</span>;
        }

        <span class="keywordflow">if</span>(effectApplied) {
                EnteredBuilding-&gt;SetLayer(Layer::Ground);
        }
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3a99ceb814144b0e760b723e81bfc075"></a><!-- doxytag: member="BuildingExt::ExtData::InvalidatePointer" ref="a3a99ceb814144b0e760b723e81bfc075" args="(void *ptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void BuildingExt::ExtData::InvalidatePointer </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="class_extension.html#a9e6b2ac570eddadb2ca3c01668da88b8">Extension&lt; TT &gt;</a>.</p>
<div class="fragment"><pre class="fragment">                                                          {
                        AnnounceInvalidPointer(<a class="code" href="class_building_ext_1_1_ext_data.html#afead3304480fed76856d3e8048dc020d" title="Contains the house which owned this building prior to it being raided and turned over to the raiding ...">OwnerBeforeRaid</a>, ptr);
                }
</pre></div>
</div>
</div>
<a class="anchor" id="a39cc147927fcbc639e64d3261d415442"></a><!-- doxytag: member="BuildingExt::ExtData::isLinkable" ref="a39cc147927fcbc639e64d3261d415442" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BuildingExt::ExtData::isLinkable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns true if this is a structure that can be linked to other structures, like a wall, fence, or trench. This is used to quick-check if the game has to look for linkable buildings in the first place. </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="class_building_ext_1_1_ext_data.html#a85968e3b639ee4a5b6c62c27fec80f26" title="Checks if the current building can link to the given target building.">canLinkTo()</a> </dd></dl>
<div class="fragment"><pre class="fragment">                                    {
        <a class="code" href="class_building_type_ext_1_1_ext_data.html">BuildingTypeExt::ExtData</a>* typeExtData = <a class="code" href="class_building_type_ext.html#a9643fa629dd6d2a20eeefa4942d8612a">BuildingTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(this-&gt;<a class="code" href="class_extension.html#a72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>-&gt;Type);
        <span class="keywordflow">return</span> typeExtData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#ad1b081e29f662a7f14228317bd86ae5a">IsLinkable</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9e1fb291c1b79b60802734e41da10db4"></a><!-- doxytag: member="BuildingExt::ExtData::KickOutOfRubble" ref="a9e1fb291c1b79b60802734e41da10db4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BuildingExt::ExtData::KickOutOfRubble </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Bumps all Technos that reside on a building's foundation out of the way. </p>
<p>All units on the building's foundation are kicked out.</p>
<dl class="author"><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>2010-06-27 </dd></dl>
<div class="fragment"><pre class="fragment">                                         {
        BuildingClass* pBld = this-&gt;<a class="code" href="class_extension.html#a72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>;

        <span class="keywordflow">if</span>(<a class="code" href="class_building_type_ext_1_1_ext_data.html">BuildingTypeExt::ExtData</a> *pData = <a class="code" href="class_building_type_ext.html#a9643fa629dd6d2a20eeefa4942d8612a">BuildingTypeExt::ExtMap</a>.Find(pBld-&gt;Type)) {
                <span class="comment">// get the number of cells and a pointer to the cell data</span>
                <span class="keywordtype">int</span> length = 0, height = 0, width = 0;
                CellStruct *data = NULL;
                <span class="keywordflow">if</span>(pData-&gt;IsCustom) {
                        width = pData-&gt;CustomWidth;
                        height = pData-&gt;CustomHeight;
                        data = pData-&gt;CustomData;
                } <span class="keywordflow">else</span> {
                        <span class="comment">// these are length constants derived from the fnd_* constants</span>
                        <span class="keywordtype">int</span> fnd_widths[] = {1, 2, 1, 2, 2, 3, 3, 3, 4, 3, 1, 3, 4, 1, 1, 2, 2, 5, 4, 3, 6, 0};
                        <span class="keywordtype">int</span> fnd_heights[] = {1, 1, 2, 2, 3, 2, 3, 5, 2, 3, 3, 1, 3, 4, 5, 6, 5, 3, 4, 4, 4, 0};
                        width = fnd_widths[pBld-&gt;Type-&gt;Foundation];
                        height = fnd_heights[pBld-&gt;Type-&gt;Foundation];
                        data = pBld-&gt;Type-&gt;FoundationData;
                }
                length = height * width;

                <span class="comment">// iterate over all cells and remove all infantry</span>
                DynamicVectorClass&lt;TechnoClass*&gt; *list = <span class="keyword">new</span> DynamicVectorClass&lt;TechnoClass*&gt;();
                DynamicVectorClass&lt;bool&gt; *sel = <span class="keyword">new</span> DynamicVectorClass&lt;bool&gt;();
                CellStruct location = MapClass::Instance-&gt;GetCellAt(&amp;pBld-&gt;Location)-&gt;MapCoords;
                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;length; ++i) {
                        CellStruct pos = data[i];
                        <span class="keywordflow">if</span>((pos.X != 0x7FFF) &amp;&amp; (pos.Y != 0x7FFF)) {
                                pos += location;

                                <span class="comment">// remove every techno that resides on this cell</span>
                                CellClass* cell = MapClass::Instance-&gt;GetCellAt(&amp;pos);
                                <span class="keywordflow">for</span>(ObjectClass* pObj = cell-&gt;GetContent(); pObj; pObj = pObj-&gt;NextObject) {
                                        <span class="keywordflow">if</span>(TechnoClass* pTech = generic_cast&lt;FootClass*&gt;(pObj)) {
                                                <span class="keywordtype">bool</span> bSel = pTech-&gt;IsSelected;
                                                <span class="keywordflow">if</span>(pTech-&gt;Remove()) {
                                                        list-&gt;AddItem(pTech);
                                                        sel-&gt;AddItem(bSel);
                                                }
                                        }
                                }
                        } <span class="keywordflow">else</span> {
                                <span class="comment">// invalid cell.</span>
                                <span class="keywordflow">break</span>;
                        }
                }

                <span class="comment">// this part kicks out all units we found in the rubble</span>
                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;list-&gt;Count; ++i) {
                        TechnoClass* pTech = list-&gt;GetItem(i);
                        pBld-&gt;KickOutUnit(pTech, &amp;location);
                        <span class="keywordflow">if</span>(sel-&gt;GetItem(i)) {
                                pTech-&gt;Select();
                        }
                }

                <span class="keyword">delete</span> list;
                <span class="keyword">delete</span> sel;
        }
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa52160d197643b1ec47982baea06a2cd"></a><!-- doxytag: member="BuildingExt::ExtData::ReverseEngineer" ref="aa52160d197643b1ec47982baea06a2cd" args="(TechnoClass *Victim)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BuildingExt::ExtData::ReverseEngineer </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&#160;</td>
          <td class="paramname"><em>Victim</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns true if Victim wasn't buildable and now should be. </p>
<div class="fragment"><pre class="fragment">                                                            {
        <a class="code" href="class_building_type_ext_1_1_ext_data.html">BuildingTypeExt::ExtData</a> *pReverseData = <a class="code" href="class_building_type_ext.html#a9643fa629dd6d2a20eeefa4942d8612a">BuildingTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(this-&gt;<a class="code" href="class_extension.html#a72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>-&gt;Type);
        <span class="keywordflow">if</span>(!pReverseData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#abd1c514360e334678e3e62a0ae50c297">ReverseEngineersVictims</a>) {
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }

        TechnoTypeClass * VictimType = Victim-&gt;GetTechnoType();
        <a class="code" href="class_techno_type_ext_1_1_ext_data.html">TechnoTypeExt::ExtData</a> *pVictimData = <a class="code" href="class_techno_type_ext.html#acc5f01db1b341572a92ad754a7d15c48">TechnoTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(VictimType);

        <span class="keywordflow">if</span>(!pVictimData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#aa9157bd8e827f81b9efc6d73e3ab9d73">CanBeReversed</a>) {
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
        }

        HouseClass *Owner = this-&gt;<a class="code" href="class_extension.html#a72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>-&gt;Owner;

        <span class="keywordtype">int</span> idx = HouseClass::Array-&gt;FindItemIndex(&amp;Owner);

        <span class="keywordflow">if</span>(pVictimData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#aa04bc25ff69390fa0a1b3e1ea3ac1a90">ReversedByHouses</a>.ValidIndex(idx)) {
                <span class="keywordflow">if</span>(!pVictimData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#aa04bc25ff69390fa0a1b3e1ea3ac1a90">ReversedByHouses</a>[idx]) {

                        <span class="keywordtype">bool</span> WasBuildable = <a class="code" href="class_house_ext.html#a1398e2ed89a5f517c53f86fdb5278682">HouseExt::PrereqValidate</a>(Owner, VictimType, <span class="keyword">false</span>, <span class="keyword">true</span>) == 1;
                        pVictimData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#aa04bc25ff69390fa0a1b3e1ea3ac1a90">ReversedByHouses</a>[idx] = <span class="keyword">true</span>;
                        <span class="keywordflow">if</span>(!WasBuildable) {
                                <span class="keywordtype">bool</span> IsBuildable = <a class="code" href="class_house_ext.html#a7c0ef179388075d71345f21fbc1d1808">HouseExt::RequirementsMet</a>(Owner, VictimType) != <a class="code" href="class_house_ext.html#aee273053817bfab24d616b7967d918e2a13fdf9cd7fb5b0681adac4a95d9cb15a">HouseExt::Forbidden</a>;
                                <span class="keywordflow">if</span>(IsBuildable) {
                                        Owner-&gt;ShouldRecheckTechTree = <span class="keyword">true</span>;
                                        <span class="keywordflow">return</span> <span class="keyword">true</span>;
                                }
                        }
                }
        }
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a11c2bdd38f872dccf64d147cbcffbadf"></a><!-- doxytag: member="BuildingExt::ExtData::RubbleYell" ref="a11c2bdd38f872dccf64d147cbcffbadf" args="(bool beingRepaired=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BuildingExt::ExtData::RubbleYell </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>beingRepaired</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function switches the building into its Advanced Rubble state or back to normal. </p>
<p>If no respective target-state object exists in the <a class="el" href="class_building_ext_1_1_ext_data.html">ExtData</a> so far, the function will create it. It'll check beforehand whether the necessary Rubble.Intact or Rubble.Destroyed are actually set on the type. If the necessary one is not set, it'll log a debug message and abort.</p>
<p>Rubble is set to full health on placing, since, no matter what we do in the backend, to the player, each pile of rubble is a new one. The reconstructed building, on the other hand, is set to 1% of it's health, since it was just no reconstructed, and not freshly built or repaired yet.</p>
<p>Lastly, the function will set the current building as the alternate state on the other state, to ensure that, if the other state gets triggered back, it is connected to this state. (e.g. when a building is turned into rubble, the normal state will set itself as the normal state of the rubble, so when the rubble is reconstructed, it switches back to the correct normal state.)</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">beingRepaired</td><td>if set to true, the function will turn the building back into its normal state. If false or unset, the building will be turned into rubble.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if the new state could be deployed, false otherwise.</dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>Renegade </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>16.12.09+ </dd></dl>
<div class="fragment"><pre class="fragment">                                                      {
        BuildingClass* currentBuilding = this-&gt;<a class="code" href="class_extension.html#a72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>;
        <a class="code" href="class_building_type_ext_1_1_ext_data.html">BuildingTypeExt::ExtData</a>* pTypeData = <a class="code" href="class_building_type_ext.html#a9643fa629dd6d2a20eeefa4942d8612a">BuildingTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(currentBuilding-&gt;Type);
        BuildingClass* newState = NULL;

        currentBuilding-&gt;Remove(); <span class="comment">// only takes it off the map</span>
        currentBuilding-&gt;DestroyNthAnim(BuildingAnimSlot::All);

        <span class="keywordflow">if</span>(beingRepaired) {
                <span class="keywordflow">if</span>(!pTypeData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#a195211051f84e98705aefd9d031ce20a" title="What BuildingType to turn into when reconstructed. (This is the normal building, set on rubble...">RubbleIntact</a>) {
                        Debug::Log(<span class="stringliteral">&quot;Warning! Advanced Rubble was supposed to be reconstructed but Ares could not obtain its normal state. \</span>
<span class="stringliteral">                        Check if [%s]Rubble.Intact is set (correctly).\n&quot;</span>, currentBuilding-&gt;Type-&gt;ID);
                        <span class="keywordflow">return</span> <span class="keyword">true</span>;
                }

                newState = specific_cast&lt;BuildingClass *&gt;(pTypeData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#a195211051f84e98705aefd9d031ce20a" title="What BuildingType to turn into when reconstructed. (This is the normal building, set on rubble...">RubbleIntact</a>-&gt;CreateObject(currentBuilding-&gt;Owner));
                newState-&gt;Health = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::max((newState-&gt;Type-&gt;Strength / 100), 1)); <span class="comment">// see description above</span>
                newState-&gt;IsAlive = <span class="keyword">true</span>; <span class="comment">// assuming this is in the sense of &quot;is not destroyed&quot;</span>
                <span class="comment">// Location should not be changed by removal</span>
                <span class="keywordflow">if</span>(!newState-&gt;Put(&amp;currentBuilding-&gt;Location, currentBuilding-&gt;Facing)) {
                        Debug::Log(<span class="stringliteral">&quot;Advanced Rubble: Failed to place normal state on map!\n&quot;</span>);
                        GAME_DEALLOC(newState);
                        <span class="keywordflow">return</span> <span class="keyword">false</span>;
                }
                <span class="comment">// currentBuilding-&gt;UnInit(); DON&#39;T DO THIS</span>

        } <span class="keywordflow">else</span> { <span class="comment">// if we&#39;re not here to repair that thing, obviously, we&#39;re gonna crush it</span>
                <span class="keywordflow">if</span>(!pTypeData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#a132ac1f6c233fb50770e19cef876d725" title="What BuildingType to turn into when destroyed. (This is the rubble, set on normal buildings...">RubbleDestroyed</a>) {
                        Debug::Log(<span class="stringliteral">&quot;Warning! Building was supposed to be turned into Advanced Rubble but Ares could not obtain its rubble state. \</span>
<span class="stringliteral">                        Check if [%s]Rubble.Destroyed is set (correctly).\n&quot;</span>, currentBuilding-&gt;Type-&gt;ID);
                        <span class="keywordflow">return</span> <span class="keyword">true</span>;
                }

                newState = specific_cast&lt;BuildingClass *&gt;(pTypeData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#a132ac1f6c233fb50770e19cef876d725" title="What BuildingType to turn into when destroyed. (This is the rubble, set on normal buildings...">RubbleDestroyed</a>-&gt;CreateObject(currentBuilding-&gt;Owner));
                <span class="comment">// Location should not be changed by removal</span>
                <span class="keywordflow">if</span>(!newState-&gt;Put(&amp;currentBuilding-&gt;Location, currentBuilding-&gt;Facing)) {
                        Debug::Log(<span class="stringliteral">&quot;Advanced Rubble: Failed to place rubble state on map!\n&quot;</span>);
                        GAME_DEALLOC(newState);
                }
        }

        <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a88c90fd40e919715f1d0ccabcd0c8121"></a><!-- doxytag: member="BuildingExt::ExtData::sameTrench" ref="a88c90fd40e919715f1d0ccabcd0c8121" args="(BuildingClass *targetBuilding)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BuildingExt::ExtData::sameTrench </td>
          <td>(</td>
          <td class="paramtype">BuildingClass *&#160;</td>
          <td class="paramname"><em>targetBuilding</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function checks if the current and the target building are both of the same trench kind. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">targetBuilding</td><td>a pointer to the target building. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if both buildings are trenches and are of the same trench kind, otherwise false.</dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>Renegade </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>25.12.09+ </dd></dl>
<div class="fragment"><pre class="fragment">                                                                 {
        <a class="code" href="class_building_type_ext_1_1_ext_data.html">BuildingTypeExt::ExtData</a>* currentTypeExtData = <a class="code" href="class_building_type_ext.html#a9643fa629dd6d2a20eeefa4942d8612a">BuildingTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(this-&gt;<a class="code" href="class_extension.html#a72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>-&gt;Type);
        <a class="code" href="class_building_type_ext_1_1_ext_data.html">BuildingTypeExt::ExtData</a>* targetTypeExtData = <a class="code" href="class_building_type_ext.html#a9643fa629dd6d2a20eeefa4942d8612a">BuildingTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(targetBuilding-&gt;Type);

        <span class="keywordflow">return</span> ((currentTypeExtData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#aa02e71a646a25fdfdab06cd89a303a1c" title="Enables moving between segments - saves ID of a kind of trench.">IsTrench</a> &gt; -1) &amp;&amp; (currentTypeExtData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#aa02e71a646a25fdfdab06cd89a303a1c" title="Enables moving between segments - saves ID of a kind of trench.">IsTrench</a> == targetTypeExtData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#aa02e71a646a25fdfdab06cd89a303a1c" title="Enables moving between segments - saves ID of a kind of trench.">IsTrench</a>));
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9a142e25874321613a711b2f196a5982"></a><!-- doxytag: member="BuildingExt::ExtData::Size" ref="a9a142e25874321613a711b2f196a5982" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual size_t BuildingExt::ExtData::Size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="class_extension.html#a44ddedd12613b24b7b03d21982782047">Extension&lt; TT &gt;</a>.</p>
<div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <span class="keyword">sizeof</span>(*this); };
</pre></div>
</div>
</div>
<a class="anchor" id="a0ed3f40c70d8c03aca843297a3587b30"></a><!-- doxytag: member="BuildingExt::ExtData::UpdateFirewall" ref="a0ed3f40c70d8c03aca843297a3587b30" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BuildingExt::ExtData::UpdateFirewall </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">                                        {
        BuildingClass *B = this-&gt;<a class="code" href="class_extension.html#a72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>;
        BuildingTypeClass *BT = B-&gt;Type;
        HouseClass *H = B-&gt;Owner;
        <a class="code" href="class_building_type_ext_1_1_ext_data.html">BuildingTypeExt::ExtData</a>* pTypeData = <a class="code" href="class_building_type_ext.html#a9643fa629dd6d2a20eeefa4942d8612a">BuildingTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(BT);

        <span class="keywordflow">if</span>(!pTypeData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#a546647f34224bbd9057c36ea89eb4763">Firewall_Is</a>) {
                <span class="keywordflow">return</span>;
        }

        <a class="code" href="class_house_ext_1_1_ext_data.html">HouseExt::ExtData</a> *pHouseData = <a class="code" href="class_house_ext.html#a4a73e500fabd21a7359c5247c31d4c03">HouseExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(H);
        <span class="keywordtype">bool</span> FS = pHouseData-&gt;<a class="code" href="class_house_ext_1_1_ext_data.html#aeecf8c826fb89045759820e0aa6d4f55">FirewallActive</a>;

        DWORD FWFrame = <a class="code" href="class_building_ext.html#a223949406041a5bcab3aeca6730375b2">BuildingExt::GetFirewallFlags</a>(B);
        <span class="keywordflow">if</span>(FS) {
                FWFrame += 32;
        }

        <span class="keywordflow">if</span>(B-&gt;FirestormWallFrame != FWFrame) {
                <span class="keywordflow">if</span>(!pHouseData-&gt;<a class="code" href="class_house_ext_1_1_ext_data.html#ab13d960ad703172d035cc9d22f36a1f8">FirewallRecalc</a>) {
                        pHouseData-&gt;<a class="code" href="class_house_ext_1_1_ext_data.html#ab13d960ad703172d035cc9d22f36a1f8">FirewallRecalc</a> = 1;
                }
                B-&gt;FirestormWallFrame = FWFrame;
                B-&gt;GetCell()-&gt;Setup(0xFFFFFFFF);
                B-&gt;SetLayer(Layer::Ground); <span class="comment">// HACK - repaints properly</span>
        }

        <span class="keywordflow">if</span>(!FS) {
                <span class="keywordflow">return</span>;
        }

        <span class="keywordflow">if</span>(!(Unsorted::CurrentFrame % 7) &amp;&amp; ScenarioClass::Instance-&gt;Random.RandomRanged(0, 15) == 1) {
                <span class="keywordtype">int</span> corners = (FWFrame &amp; 0xF); <span class="comment">// 1111b</span>
                <span class="keywordflow">if</span>(AnimClass *IdleAnim = B-&gt;FirestormAnim) {
                        GAME_DEALLOC(IdleAnim);
                        B-&gt;FirestormAnim = 0;
                }
                <span class="keywordflow">if</span>(corners != 5 &amp;&amp; corners != 10) {  <span class="comment">// (0101b || 1010b) == part of a straight line</span>
                        CoordStruct XYZ;
                        B-&gt;GetCoords(&amp;XYZ);
                        XYZ.X -= 768;
                        XYZ.Y -= 768;
                        <span class="keywordflow">if</span>(AnimTypeClass *FSA = AnimTypeClass::Find(<span class="stringliteral">&quot;FSIDLE&quot;</span>)) {
                                GAME_ALLOC(AnimClass, B-&gt;FirestormAnim, FSA, &amp;XYZ);
                        }
                }
        }

        this-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a21a5f7c8f4bb43c82dcc2e03b6681291">ImmolateVictims</a>();
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="aa94d26e570d86791fabc7919e238a6fc"></a><!-- doxytag: member="BuildingExt::ExtData::AboutToChronoshift" ref="aa94d26e570d86791fabc7919e238a6fc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_building_ext_1_1_ext_data.html#aa94d26e570d86791fabc7919e238a6fc">BuildingExt::ExtData::AboutToChronoshift</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This building is going to be shifted. It should not be attacked with temporal weapons now. Otherwise it would disappear. </p>

</div>
</div>
<a class="anchor" id="ab5ab1574ad150a14f8e46f2a08094cda"></a><!-- doxytag: member="BuildingExt::ExtData::FreeUnits_Done" ref="ab5ab1574ad150a14f8e46f2a08094cda" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_building_ext_1_1_ext_data.html#ab5ab1574ad150a14f8e46f2a08094cda">BuildingExt::ExtData::FreeUnits_Done</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Prevent free units and aircraft to be created multiple times. Set when the free units have been granted. </p>

</div>
</div>
<a class="anchor" id="a0d8c28c2f33fc5710e8aa2dd8da374e0"></a><!-- doxytag: member="BuildingExt::ExtData::ignoreNextEVA" ref="a0d8c28c2f33fc5710e8aa2dd8da374e0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_building_ext_1_1_ext_data.html#a0d8c28c2f33fc5710e8aa2dd8da374e0">BuildingExt::ExtData::ignoreNextEVA</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This is used when returning raided buildings, to decide whether to play EVA announcements about building capture. </p>

</div>
</div>
<a class="anchor" id="afa7ba845c44fb28da0ffdf2b7b7c5667"></a><!-- doxytag: member="BuildingExt::ExtData::isCurrentlyRaided" ref="afa7ba845c44fb28da0ffdf2b7b7c5667" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_building_ext_1_1_ext_data.html#afa7ba845c44fb28da0ffdf2b7b7c5667">BuildingExt::ExtData::isCurrentlyRaided</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Whether this building is currently occupied by someone not the actual owner of the structure. </p>

</div>
</div>
<a class="anchor" id="afead3304480fed76856d3e8048dc020d"></a><!-- doxytag: member="BuildingExt::ExtData::OwnerBeforeRaid" ref="afead3304480fed76856d3e8048dc020d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HouseClass* <a class="el" href="class_building_ext_1_1_ext_data.html#afead3304480fed76856d3e8048dc020d">BuildingExt::ExtData::OwnerBeforeRaid</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Contains the house which owned this building prior to it being raided and turned over to the raiding party. </p>

</div>
</div>
<a class="anchor" id="a9e84d85afa2e0cf6012a0b58851011b4"></a><!-- doxytag: member="BuildingExt::ExtData::PrismForwarding" ref="a9e84d85afa2e0cf6012a0b58851011b4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_building_ext_1_1c_prism_forwarding.html">cPrismForwarding</a> <a class="el" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">BuildingExt::ExtData::PrismForwarding</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad7f420d1c0f2af081419b11913a5a17f"></a><!-- doxytag: member="BuildingExt::ExtData::RegisteredJammers" ref="ad7f420d1c0f2af081419b11913a5a17f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;TechnoClass *&gt; <a class="el" href="class_building_ext_1_1_ext_data.html#ad7f420d1c0f2af081419b11913a5a17f">BuildingExt::ExtData::RegisteredJammers</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set of Radar Jammers which have registered themselves to be in range of this building. (Related to issue #305) </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/Ext/Building/<a class="el" href="_building_2_body_8h.html">Body.h</a></li>
<li>src/Ext/Building/<a class="el" href="_building_2_body_8cpp.html">Body.cpp</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Mon Oct 17 2011 23:42:32 for Ares by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
