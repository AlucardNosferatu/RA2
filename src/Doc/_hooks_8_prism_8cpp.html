<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Ares: src/Ext/Building/Hooks.Prism.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Ares</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_61edef5b85f25cd5be6bbdff5e99e478.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_de16222cf794c2cbeaf77d0392606035.html">Ext</a>      </li>
      <li class="navelem"><a class="el" href="dir_26aed8f7ef5ae871777bc690ae5b9a4b.html">Building</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>Hooks.Prism.cpp File Reference</h1>  </div>
</div>
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="_building_2_body_8h.html">Body.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="_building_type_2_body_8h.html">../BuildingType/Body.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="_weapon_type_2_body_8h.html">../WeaponType/Body.h</a>&quot;</code><br/>
<code>#include &lt;BulletClass.h&gt;</code><br/>
<code>#include &lt;LaserDrawClass.h&gt;</code><br/>
</div><table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_hooks_8_prism_8cpp.html#a05da551792fcf80f942f107dcd5b005e">DEFINE_HOOK</a> (44B2FE, BuildingClass_Mi_Attack_IsPrism, 6)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_hooks_8_prism_8cpp.html#afa1587da2838cfdc619e3bcbfd7b9dc8">DEFINE_HOOK</a> (447FAE, BuildingClass_GetObjectActivityState, 6)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_hooks_8_prism_8cpp.html#ab562500f0466777d5c89b3f7015cb462">DEFINE_HOOK</a> (4503F0, BuildingClass_Update_Prism, 9)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_hooks_8_prism_8cpp.html#a811a322bd6d1d35b664090e573e70102">DEFINE_HOOK</a> (44ABD0, BuildingClass_FireLaser, 5)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_hooks_8_prism_8cpp.html#a0189cb684bae7f60edd55566024aa664">DEFINE_HOOK</a> (4424EF, PrismForward_BuildingDestroyed, 6)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_hooks_8_prism_8cpp.html#ae739070a90738090023712bda8660fee">DEFINE_HOOK</a> (447113, PrismForward_BuildingSold, 6)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_hooks_8_prism_8cpp.html#a20cc90f0e4c88edc71495ba21f367200">DEFINE_HOOK</a> (448277, PrismForward_BuildingChangeOwner, 5)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_hooks_8_prism_8cpp.html#a07b39e551a6f5695c35378bc136d109b">DEFINE_HOOK</a> (71AF76, PrismForward_BuildingWarped, 9)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_hooks_8_prism_8cpp.html#aacd80562c2764724afea46eac9feb80d">DEFINE_HOOK</a> (70FD9A, PrismForward_BuildingDrain, 6)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_hooks_8_prism_8cpp.html#ae69b082d038255fdf8130abbc4dd6435">DEFINE_HOOK</a> (454B3D, PrismForward_BuildingPowerDown, 6)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_hooks_8_prism_8cpp.html#a48168973c5e6570796cfbf55ce8e9258">DEFINE_HOOK</a> (44EBF0, PrismForward_BuildingRemoved, 5)</td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a05da551792fcf80f942f107dcd5b005e"></a><!-- doxytag: member="Hooks.Prism.cpp::DEFINE_HOOK" ref="a05da551792fcf80f942f107dcd5b005e" args="(44B2FE, BuildingClass_Mi_Attack_IsPrism, 6)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DEFINE_HOOK </td>
          <td>(</td>
          <td class="paramtype">44B2FE&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BuildingClass_Mi_Attack_IsPrism&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">6&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
        GET(BuildingClass *, B, ESI);
        GET(<span class="keywordtype">int</span>, idxWeapon, EBP); <span class="comment">//which weapon was chosen to attack the target with</span>
        R-&gt;EAX&lt;BuildingTypeClass *&gt;(B-&gt;Type);

        <span class="keyword">enum</span> { IsPrism = 0x44B310, IsNotPrism = 0x44B630, IsCustomPrism = 0x44B6D6};

        BuildingTypeClass *pMasterType = B-&gt;Type;
        <a class="code" href="class_building_type_ext_1_1_ext_data.html">BuildingTypeExt::ExtData</a> *pMasterTypeData = <a class="code" href="class_building_type_ext.html#a9643fa629dd6d2a20eeefa4942d8612a">BuildingTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(pMasterType);

        <span class="keywordflow">if</span> (pMasterTypeData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#ad94d1b69f0f09a2d1175bfa2c8d3020c">PrismForwarding</a>.Enabled == <a class="code" href="class_building_type_ext_1_1c_prism_forwarding.html#ab706cdaa7ac0828972d1febcc34b0c7ea1797f609d0087b32a726d62adf745697">BuildingTypeExt::cPrismForwarding::YES</a>
                || pMasterTypeData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#ad94d1b69f0f09a2d1175bfa2c8d3020c">PrismForwarding</a>.Enabled == <a class="code" href="class_building_type_ext_1_1c_prism_forwarding.html#ab706cdaa7ac0828972d1febcc34b0c7ea24ceb2c84b7108f1ba74837d65d96ef3">BuildingTypeExt::cPrismForwarding::ATTACK</a>) {

                <a class="code" href="class_building_ext_1_1_ext_data.html">BuildingExt::ExtData</a> *pMasterData = <a class="code" href="class_building_ext.html#abae25aca766faa296092dea1dc69cff7">BuildingExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(B);

                <span class="keywordflow">if</span> (B-&gt;PrismStage == pcs_Idle) {
                        B-&gt;PrismStage = pcs_Master;
                        B-&gt;DelayBeforeFiring = B-&gt;Type-&gt;DelayedFireDelay;

                        B-&gt;PrismTargetCoords.X = 0;
                        <span class="keywordflow">if</span> (pMasterType-&gt;get_Secondary()) {
                                <span class="keywordflow">if</span> (B-&gt;IsOverpowered) {
                                        B-&gt;PrismTargetCoords.X = 1;
                                }
                        }

                        B-&gt;PrismTargetCoords.Y = B-&gt;PrismTargetCoords.Z = 0;
                        pMasterData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.ModifierReserve = 0.0;
                        pMasterData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.DamageReserve = 0;

                        <span class="keywordtype">int</span> LongestChain = 0;

                        <span class="comment">//set up slaves</span>
                        <span class="keywordtype">int</span> NetworkSize = 0;
                        <span class="keywordtype">int</span> stage = 0;

                        <span class="comment">//when it reaches zero we can&#39;t acquire any more slaves</span>
                        <span class="keywordflow">while</span> (<a class="code" href="class_building_type_ext_1_1c_prism_forwarding.html#a0d7f210210db1921c63d4444f45540a0">BuildingTypeExt::cPrismForwarding::AcquireSlaves_MultiStage</a>(B, B, stage++, 0, &amp;NetworkSize, &amp;LongestChain) != 0) {}

                        <span class="comment">//now we have all the towers we know the longest chain, and can set all the towers&#39; charge delays</span>
                        <a class="code" href="class_building_type_ext_1_1c_prism_forwarding.html#afb92d5e5b3188bd1a3b3eb63aba61cb6">BuildingTypeExt::cPrismForwarding::SetChargeDelay</a>(B, LongestChain);

                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (B-&gt;PrismStage == pcs_Slave) {
                        <span class="comment">//a slave tower is changing into a master tower at the last second</span>
                        B-&gt;PrismStage = pcs_Master;
                        B-&gt;PrismTargetCoords.X = 0;
                        <span class="keywordflow">if</span> (pMasterType-&gt;get_Secondary()) {
                                <span class="keywordflow">if</span> (B-&gt;IsOverpowered) {
                                        B-&gt;PrismTargetCoords.X = 1;
                                }
                        }
                        B-&gt;PrismTargetCoords.Y = B-&gt;PrismTargetCoords.Z = 0;
                        pMasterData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.ModifierReserve = 0.0;
                        pMasterData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.DamageReserve = 0;
                        pMasterData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.SupportTarget = NULL;

                }

                <span class="keywordflow">return</span> IsCustomPrism; <span class="comment">//always custom, the new code is a complete rewrite of the old code</span>

        }

        <span class="keywordflow">return</span> IsNotPrism;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a48168973c5e6570796cfbf55ce8e9258"></a><!-- doxytag: member="Hooks.Prism.cpp::DEFINE_HOOK" ref="a48168973c5e6570796cfbf55ce8e9258" args="(44EBF0, PrismForward_BuildingRemoved, 5)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DEFINE_HOOK </td>
          <td>(</td>
          <td class="paramtype">44EBF0&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PrismForward_BuildingRemoved&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">5&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
        GET(BuildingClass *, B, ECX);
        <a class="code" href="class_building_type_ext_1_1c_prism_forwarding.html#a5206e79b50240897a6d33b76cbd1905d">BuildingTypeExt::cPrismForwarding::RemoveFromNetwork</a>(B, <span class="keyword">true</span>);
        <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae69b082d038255fdf8130abbc4dd6435"></a><!-- doxytag: member="Hooks.Prism.cpp::DEFINE_HOOK" ref="ae69b082d038255fdf8130abbc4dd6435" args="(454B3D, PrismForward_BuildingPowerDown, 6)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DEFINE_HOOK </td>
          <td>(</td>
          <td class="paramtype">454B3D&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PrismForward_BuildingPowerDown&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">6&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
        GET(BuildingClass *, B, ESI);
        <span class="comment">// this building just realised it needs to go offline</span>
        <span class="comment">// it unregistered itself from powered unit controls but hasn&#39;t done anything else yet</span>
        <a class="code" href="class_building_type_ext_1_1c_prism_forwarding.html#a5206e79b50240897a6d33b76cbd1905d">BuildingTypeExt::cPrismForwarding::RemoveFromNetwork</a>(B, <span class="keyword">true</span>);
        <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aacd80562c2764724afea46eac9feb80d"></a><!-- doxytag: member="Hooks.Prism.cpp::DEFINE_HOOK" ref="aacd80562c2764724afea46eac9feb80d" args="(70FD9A, PrismForward_BuildingDrain, 6)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DEFINE_HOOK </td>
          <td>(</td>
          <td class="paramtype">70FD9A&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PrismForward_BuildingDrain&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">6&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
        GET(TechnoClass *, Drainer, ESI);
        GET(TechnoClass *, Drainee, EDI);
        <span class="keywordflow">if</span>(Drainee-&gt;DrainingMe != Drainer) { <span class="comment">// else we&#39;re already being drained, nothing to do</span>
                <span class="keywordflow">if</span> (BuildingClass * B = specific_cast&lt;BuildingClass *&gt;(Drainee)) {
                        <a class="code" href="class_building_type_ext_1_1c_prism_forwarding.html#a5206e79b50240897a6d33b76cbd1905d">BuildingTypeExt::cPrismForwarding::RemoveFromNetwork</a>(B, <span class="keyword">true</span>);
                }
        }
        <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a07b39e551a6f5695c35378bc136d109b"></a><!-- doxytag: member="Hooks.Prism.cpp::DEFINE_HOOK" ref="a07b39e551a6f5695c35378bc136d109b" args="(71AF76, PrismForward_BuildingWarped, 9)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DEFINE_HOOK </td>
          <td>(</td>
          <td class="paramtype">71AF76&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PrismForward_BuildingWarped&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">9&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">                                                    {
        GET(TechnoClass *, T, EDI);
        <span class="keywordflow">if</span> (BuildingClass * B = specific_cast&lt;BuildingClass *&gt;(T)) {
                <a class="code" href="class_building_type_ext_1_1c_prism_forwarding.html#a5206e79b50240897a6d33b76cbd1905d">BuildingTypeExt::cPrismForwarding::RemoveFromNetwork</a>(B, <span class="keyword">true</span>);
        }
        <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a20cc90f0e4c88edc71495ba21f367200"></a><!-- doxytag: member="Hooks.Prism.cpp::DEFINE_HOOK" ref="a20cc90f0e4c88edc71495ba21f367200" args="(448277, PrismForward_BuildingChangeOwner, 5)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DEFINE_HOOK </td>
          <td>(</td>
          <td class="paramtype">448277&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PrismForward_BuildingChangeOwner&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">5&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
        GET(BuildingClass *, B, ESI);
        GET_STACK(HouseClass *, newOwner, 0x5C);
        
        HouseClass * oldOwner = B-&gt;Owner;

        <span class="keywordflow">if</span> (newOwner != oldOwner) {
                BuildingTypeClass *pType = B-&gt;Type;
                <a class="code" href="class_building_type_ext_1_1_ext_data.html">BuildingTypeExt::ExtData</a> *pTypeData = <a class="code" href="class_building_type_ext.html#a9643fa629dd6d2a20eeefa4942d8612a">BuildingTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(pType);

                <span class="keywordflow">if</span> (pTypeData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#ad94d1b69f0f09a2d1175bfa2c8d3020c">PrismForwarding</a>.ToAllies) {
                        BuildingClass *LastTarget = B;
                        BuildingClass *FirstTarget = NULL;
                        <span class="keywordflow">while</span> (LastTarget) {
                                <a class="code" href="class_building_ext_1_1_ext_data.html">BuildingExt::ExtData</a> *pData = <a class="code" href="class_building_ext.html#abae25aca766faa296092dea1dc69cff7">BuildingExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(LastTarget);
                                BuildingClass *NextTarget = pData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.SupportTarget;
                                <span class="keywordflow">if</span> (!FirstTarget) {
                                        <span class="keywordflow">if</span>(!NextTarget) {
                                                <span class="comment">//no first target so either this is a master tower, an idle tower, or not a prism tower at all</span>
                                                <span class="comment">//no need to remove</span>
                                                <span class="keywordflow">return</span> 0;
                                        }
                                        FirstTarget = NextTarget;
                                }

                                <span class="keywordflow">if</span> (!NextTarget) {
                                        <span class="comment">//LastTarget is now the master (firing) tower</span>
                                        <span class="keywordflow">if</span> (newOwner-&gt;IsAlliedWith(LastTarget-&gt;Owner) &amp;&amp; newOwner-&gt;IsAlliedWith(FirstTarget-&gt;Owner)) {
                                                <span class="comment">//alliances check out so this slave tower can keep on charging.</span>
                                                <span class="keywordflow">return</span> 0;
                                        }
                                }
                                LastTarget = NextTarget;
                        }
                }
                <span class="comment">//if we reach this point then the alliance checks have failed</span>
                <a class="code" href="class_building_type_ext_1_1c_prism_forwarding.html#a5206e79b50240897a6d33b76cbd1905d">BuildingTypeExt::cPrismForwarding::RemoveFromNetwork</a>(B, <span class="keyword">false</span>); <span class="comment">//false because animation should continue / slave is busy but won&#39;t now fire</span>
                
        }

        <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae739070a90738090023712bda8660fee"></a><!-- doxytag: member="Hooks.Prism.cpp::DEFINE_HOOK" ref="ae739070a90738090023712bda8660fee" args="(447113, PrismForward_BuildingSold, 6)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DEFINE_HOOK </td>
          <td>(</td>
          <td class="paramtype">447113&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PrismForward_BuildingSold&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">6&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
        GET(BuildingClass *, B, ESI);
        <a class="code" href="class_building_type_ext_1_1c_prism_forwarding.html#a5206e79b50240897a6d33b76cbd1905d">BuildingTypeExt::cPrismForwarding::RemoveFromNetwork</a>(B, <span class="keyword">true</span>);
        <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0189cb684bae7f60edd55566024aa664"></a><!-- doxytag: member="Hooks.Prism.cpp::DEFINE_HOOK" ref="a0189cb684bae7f60edd55566024aa664" args="(4424EF, PrismForward_BuildingDestroyed, 6)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DEFINE_HOOK </td>
          <td>(</td>
          <td class="paramtype">4424EF&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PrismForward_BuildingDestroyed&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">6&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
        GET(BuildingClass *, B, ESI);
        <a class="code" href="class_building_type_ext_1_1c_prism_forwarding.html#a5206e79b50240897a6d33b76cbd1905d">BuildingTypeExt::cPrismForwarding::RemoveFromNetwork</a>(B, <span class="keyword">true</span>);
        <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a811a322bd6d1d35b664090e573e70102"></a><!-- doxytag: member="Hooks.Prism.cpp::DEFINE_HOOK" ref="a811a322bd6d1d35b664090e573e70102" args="(44ABD0, BuildingClass_FireLaser, 5)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DEFINE_HOOK </td>
          <td>(</td>
          <td class="paramtype">44ABD0&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BuildingClass_FireLaser&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">5&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
        GET(BuildingClass *, B, ECX);
        LEA_STACK(CoordStruct *, pTargetXYZ, 0x4);

        BuildingTypeClass *pType = B-&gt;Type;
        <a class="code" href="class_building_type_ext_1_1_ext_data.html">BuildingTypeExt::ExtData</a> *pTypeData = <a class="code" href="class_building_type_ext.html#a9643fa629dd6d2a20eeefa4942d8612a">BuildingTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(pType);

        CoordStruct SourceXYZ, Base = {0, 0, 0};
        B-&gt;GetFLH(&amp;SourceXYZ, 0, Base);

        ColorStruct blank(0, 0, 0);

        <span class="keywordtype">int</span> idxSupport = -1;
        <span class="keywordflow">if</span> (B-&gt;Veterancy.IsElite()) {
                idxSupport = pTypeData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#ad94d1b69f0f09a2d1175bfa2c8d3020c">PrismForwarding</a>.EliteSupportWeaponIndex;
        } <span class="keywordflow">else</span> {
                idxSupport = pTypeData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#ad94d1b69f0f09a2d1175bfa2c8d3020c">PrismForwarding</a>.SupportWeaponIndex;
        }

        WeaponTypeClass * supportWeapon = NULL;
        <span class="keywordflow">if</span> (idxSupport != -1) {
                supportWeapon = pType-&gt;get_Weapon(idxSupport);
        }
        LaserDrawClass * LaserBeam = NULL;
        <span class="keywordflow">if</span> (supportWeapon) {
                <a class="code" href="class_weapon_type_ext_1_1_ext_data.html">WeaponTypeExt::ExtData</a> *supportWeaponData = <a class="code" href="class_weapon_type_ext.html#a6e448392133b3079a9490b5c5fabdd09">WeaponTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(supportWeapon);
                <span class="comment">//IsLaser</span>
                <span class="keywordflow">if</span> (supportWeapon-&gt;IsLaser) {
                        <span class="keywordflow">if</span> (supportWeapon-&gt;IsHouseColor) {
                                GAME_ALLOC(LaserDrawClass, LaserBeam, SourceXYZ, *pTargetXYZ, B-&gt;Owner-&gt;LaserColor, blank, blank, supportWeapon-&gt;LaserDuration);
                        } <span class="keywordflow">else</span> {
                                GAME_ALLOC(LaserDrawClass, LaserBeam, SourceXYZ, *pTargetXYZ,
                                        supportWeapon-&gt;LaserInnerColor, supportWeapon-&gt;LaserOuterColor, supportWeapon-&gt;LaserOuterSpread,
                                        supportWeapon-&gt;LaserDuration);
                        }
                        <span class="keywordflow">if</span>(LaserBeam) {
                                LaserBeam-&gt;IsHouseColor = supportWeapon-&gt;IsHouseColor;
                                <span class="comment">//basic thickness (intensity additions are added later)</span>
                                <span class="keywordflow">if</span> (supportWeaponData-&gt;<a class="code" href="class_weapon_type_ext_1_1_ext_data.html#a6b6b859df52dd176ecee8af2f59f7b54">Laser_Thickness</a> == -1) {
                                        LaserBeam-&gt;Thickness = 3; <span class="comment">//original default</span>
                                } <span class="keywordflow">else</span> {
                                        LaserBeam-&gt;Thickness = supportWeaponData-&gt;<a class="code" href="class_weapon_type_ext_1_1_ext_data.html#a6b6b859df52dd176ecee8af2f59f7b54">Laser_Thickness</a>;
                                }
                        }
                }
                <span class="comment">//IsRadBeam</span>
                <span class="keywordflow">if</span> (supportWeapon-&gt;IsRadBeam) {
                        RadBeam* supportRadBeam = RadBeam::Allocate(RadBeamType::RadBeam);
                        <span class="keywordflow">if</span> (supportRadBeam) {
                                supportRadBeam-&gt;SetCoordsSource(&amp;SourceXYZ);
                                supportRadBeam-&gt;SetCoordsTarget(pTargetXYZ);
                                <span class="keywordflow">if</span> (supportWeaponData-&gt;<a class="code" href="class_weapon_type_ext_1_1_ext_data.html#a962ab72bfeb37e0f44a7daca6820278f">Beam_IsHouseColor</a>) {
                                        supportRadBeam-&gt;Color = B-&gt;Owner-&gt;LaserColor;
                                } <span class="keywordflow">else</span> {
                                        supportRadBeam-&gt;Color = supportWeaponData-&gt;<a class="code" href="class_weapon_type_ext_1_1_ext_data.html#a2b0e63c7f6c2289def697775054eee2b">Beam_Color</a>;
                                }
                                supportRadBeam-&gt;Period = supportWeaponData-&gt;<a class="code" href="class_weapon_type_ext_1_1_ext_data.html#a1ec6b0f0fe365499e2cdcede56985ea4">Beam_Duration</a>;
                                supportRadBeam-&gt;Amplitude = supportWeaponData-&gt;<a class="code" href="class_weapon_type_ext_1_1_ext_data.html#a09607cdca748c007a2e0ead6e2b21cc7">Beam_Amplitude</a>;
                                <span class="comment">//Debug::DumpObj((byte *)supportRadBeam, sizeof(RadBeam));</span>
                        }
                }
                <span class="comment">//IsElectricBolt</span>
                <span class="keywordflow">if</span> (supportWeapon-&gt;IsElectricBolt) {
                        EBolt* supportEBolt;
                        GAME_ALLOC(EBolt, supportEBolt);
                        <span class="keywordflow">if</span> (supportEBolt) {
                                supportEBolt-&gt;AlternateColor = supportWeapon-&gt;IsAlternateColor;
                                <a class="code" href="class_weapon_type_ext.html#a2964bcc16a7b3f26c8280d3c90b66c1b">WeaponTypeExt::BoltExt</a>[supportEBolt] = <a class="code" href="class_weapon_type_ext.html#a6e448392133b3079a9490b5c5fabdd09">WeaponTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(supportWeapon);
                                supportEBolt-&gt;Fire(SourceXYZ, *pTargetXYZ, 0); <span class="comment">//messing with 3rd arg seems to make bolts more jumpy, and parts of them disappear</span>
                        }
                }
                <span class="comment">//Report</span>
                <span class="keywordflow">if</span>(supportWeapon-&gt;Report.Count &gt; 0) {
                        <span class="keywordtype">int</span> ReportIndex = ScenarioClass::Instance-&gt;Random.RandomRanged(0, supportWeapon-&gt;Report.Count - 1);
                        <span class="keywordtype">int</span> SoundArrayIndex = supportWeapon-&gt;Report.GetItem(ReportIndex);
                        <span class="keywordflow">if</span>(SoundArrayIndex != -1) {
                                VocClass::PlayAt(SoundArrayIndex, &amp;SourceXYZ, NULL);
                        }
                }
                <span class="comment">//ROF</span>
                B-&gt;ReloadTimer.Start(supportWeapon-&gt;ROF);
        } <span class="keywordflow">else</span> {
                <span class="comment">//just the default support beam</span>
                GAME_ALLOC(LaserDrawClass, LaserBeam, SourceXYZ, *pTargetXYZ, B-&gt;Owner-&gt;LaserColor, blank, blank, RulesClass::Instance-&gt;PrismSupportDuration);
                <span class="keywordflow">if</span>(LaserBeam) {
                        LaserBeam-&gt;IsHouseColor = <span class="keyword">true</span>;
                        LaserBeam-&gt;Thickness = 3;
                }
                B-&gt;ReloadTimer.Start(RulesClass::Instance-&gt;PrismSupportDelay);
        }

        <span class="comment">//Intensity adjustment for LaserBeam</span>
        <span class="keywordflow">if</span> (LaserBeam) {
                <span class="keywordflow">if</span> (pTypeData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#ad94d1b69f0f09a2d1175bfa2c8d3020c">PrismForwarding</a>.Intensity &gt; 0) {
                        <a class="code" href="class_building_ext_1_1_ext_data.html">BuildingExt::ExtData</a> *pData = <a class="code" href="class_building_ext.html#abae25aca766faa296092dea1dc69cff7">BuildingExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(B);
                        LaserBeam-&gt;Thickness += (pTypeData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#ad94d1b69f0f09a2d1175bfa2c8d3020c">PrismForwarding</a>.Intensity * (B-&gt;SupportingPrisms -1));
                }
        }

        B-&gt;SupportingPrisms = 0; <span class="comment">//not sure why Westwood set this here. We&#39;re setting it in BuildingClass_Update_Prism</span>

        <span class="keywordflow">return</span> 0x44ACE2;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab562500f0466777d5c89b3f7015cb462"></a><!-- doxytag: member="Hooks.Prism.cpp::DEFINE_HOOK" ref="ab562500f0466777d5c89b3f7015cb462" args="(4503F0, BuildingClass_Update_Prism, 9)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DEFINE_HOOK </td>
          <td>(</td>
          <td class="paramtype">4503F0&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BuildingClass_Update_Prism&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">9&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
        GET(BuildingClass *, pThis, ECX);
        <span class="keywordflow">if</span>(<span class="keywordtype">int</span> PrismStage = pThis-&gt;PrismStage) {
                <a class="code" href="class_building_ext_1_1_ext_data.html">BuildingExt::ExtData</a> *pData = <a class="code" href="class_building_ext.html#abae25aca766faa296092dea1dc69cff7">BuildingExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(pThis);
                <span class="keywordflow">if</span> (pData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.PrismChargeDelay &lt;= 0) {
                        --pThis-&gt;DelayBeforeFiring;
                        <span class="keywordflow">if</span>(pThis-&gt;DelayBeforeFiring &lt;= 0) {
                                <span class="keywordflow">if</span>(PrismStage == pcs_Slave) {
                                        <span class="keywordflow">if</span> (BuildingClass *pTarget = pData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.SupportTarget) {
                                                <a class="code" href="class_building_ext_1_1_ext_data.html">BuildingExt::ExtData</a> *pTargetData = <a class="code" href="class_building_ext.html#abae25aca766faa296092dea1dc69cff7">BuildingExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(pTarget);
                                                BuildingTypeClass *pType = pThis-&gt;Type;
                                                <a class="code" href="class_building_type_ext_1_1_ext_data.html">BuildingTypeExt::ExtData</a> *pTypeData = <a class="code" href="class_building_type_ext.html#a9643fa629dd6d2a20eeefa4942d8612a">BuildingTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(pType);
                                                <span class="comment">//slave firing</span>
                                                pTargetData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.ModifierReserve +=
                                                        (pTypeData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#ad94d1b69f0f09a2d1175bfa2c8d3020c">PrismForwarding</a>.SupportModifier.Get() + pData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.ModifierReserve);
                                                pTargetData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.DamageReserve +=
                                                        (pTypeData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#ad94d1b69f0f09a2d1175bfa2c8d3020c">PrismForwarding</a>.DamageAdd.Get()  + pData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.DamageReserve);
                                                pThis-&gt;FireLaser(pThis-&gt;PrismTargetCoords);

                                        }
                                }
                                <span class="keywordflow">if</span>(PrismStage == pcs_Master) {
                                        <span class="keywordflow">if</span>(ObjectClass *Target = pThis-&gt;Target) {
                                                <span class="keywordflow">if</span>(pThis-&gt;GetFireError(Target, pThis-&gt;PrismTargetCoords.X, <span class="keyword">true</span>) == FireError::OK) {
                                                        <span class="keywordflow">if</span>(BulletClass *LaserBeam = pThis-&gt;Fire(Target, pThis-&gt;PrismTargetCoords.X)) {
                                                                BuildingTypeClass *pType = pThis-&gt;Type;
                                                                <a class="code" href="class_building_type_ext_1_1_ext_data.html">BuildingTypeExt::ExtData</a> *pTypeData = <a class="code" href="class_building_type_ext.html#a9643fa629dd6d2a20eeefa4942d8612a">BuildingTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(pType);

                                                                <span class="comment">//apparently this is divided by 256 elsewhere</span>
                                                                LaserBeam-&gt;DamageMultiplier = ((pData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.ModifierReserve + 100) * 256) / 100;
                                                                LaserBeam-&gt;Health += pTypeData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#ad94d1b69f0f09a2d1175bfa2c8d3020c">PrismForwarding</a>.DamageAdd.Get()  + pData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.DamageReserve;
                                                        }
                                                }
                                        }
                                }
                                <span class="comment">//This tower&#39;s job is done. Go idle.</span>
                                pData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.ModifierReserve = 0.0;
                                pData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.DamageReserve = 0;
                                pData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.Senders.Clear();
                                pThis-&gt;SupportingPrisms = 0; <span class="comment">//Ares sets this to the longest backward chain</span>
                                pData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.SupportTarget = NULL;
                                pThis-&gt;PrismStage = pcs_Idle;
                        }
                } <span class="keywordflow">else</span> {
                        <span class="comment">//still in delayed charge so not actually charging yet</span>
                        --pData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.PrismChargeDelay;
                        <span class="keywordflow">if</span> (pData-&gt;<a class="code" href="class_building_ext_1_1_ext_data.html#a9e84d85afa2e0cf6012a0b58851011b4">PrismForwarding</a>.PrismChargeDelay &lt;= 0) {
                                <span class="comment">//now it&#39;s time to start charging</span>
                                <span class="keywordflow">if</span> (pThis-&gt;Type-&gt;BuildingAnim[BuildingAnimSlot::Special].Anim[0]) { <span class="comment">//only if it actually has a special anim</span>
                                        pThis-&gt;DestroyNthAnim(BuildingAnimSlot::Active);
                                        pThis-&gt;PlayNthAnim(BuildingAnimSlot::Special);
                                }
                        }
                }
        }
        <span class="keywordflow">return</span> 0x4504E2;
}
</pre></div>
</div>
</div>
<a class="anchor" id="afa1587da2838cfdc619e3bcbfd7b9dc8"></a><!-- doxytag: member="Hooks.Prism.cpp::DEFINE_HOOK" ref="afa1587da2838cfdc619e3bcbfd7b9dc8" args="(447FAE, BuildingClass_GetObjectActivityState, 6)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DEFINE_HOOK </td>
          <td>(</td>
          <td class="paramtype">447FAE&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BuildingClass_GetObjectActivityState&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">6&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<div class="fragment"><pre class="fragment">{
        GET(BuildingClass *, B, ESI);
        <span class="keyword">enum</span> { BusyCharging = 0x447FB8, NotBusyCharging = 0x447FC3};

        <span class="keywordflow">if</span>(B-&gt;DelayBeforeFiring &gt; 0) {
                <span class="comment">//if this is a slave prism tower, then it might still be able to become a master tower at this time</span>
                BuildingTypeClass *pType = B-&gt;Type;
                <a class="code" href="class_building_type_ext_1_1_ext_data.html">BuildingTypeExt::ExtData</a> *pTypeData = <a class="code" href="class_building_type_ext.html#a9643fa629dd6d2a20eeefa4942d8612a">BuildingTypeExt::ExtMap</a>.<a class="code" href="class_container.html#a90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(pType);
                <span class="keywordflow">if</span> (pTypeData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#ad94d1b69f0f09a2d1175bfa2c8d3020c">PrismForwarding</a>.Enabled == <a class="code" href="class_building_type_ext_1_1c_prism_forwarding.html#ab706cdaa7ac0828972d1febcc34b0c7ea1797f609d0087b32a726d62adf745697">BuildingTypeExt::cPrismForwarding::YES</a>
                                || pTypeData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#ad94d1b69f0f09a2d1175bfa2c8d3020c">PrismForwarding</a>.Enabled == <a class="code" href="class_building_type_ext_1_1c_prism_forwarding.html#ab706cdaa7ac0828972d1febcc34b0c7ea24ceb2c84b7108f1ba74837d65d96ef3">BuildingTypeExt::cPrismForwarding::ATTACK</a>) {
                        <span class="comment">//is a prism tower</span>
                        <span class="keywordflow">if</span> (B-&gt;PrismStage == pcs_Slave &amp;&amp; pTypeData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#ad94d1b69f0f09a2d1175bfa2c8d3020c">PrismForwarding</a>.BreakSupport) {
                                <span class="keywordflow">return</span> NotBusyCharging;
                        }
                }
                <span class="keywordflow">return</span> BusyCharging;
        }
        <span class="keywordflow">return</span> NotBusyCharging;
}
</pre></div>
</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Mon Oct 17 2011 23:42:31 for Ares by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
